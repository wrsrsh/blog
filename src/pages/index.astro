---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import Layout from "../components/Layout.astro";

const posts = (await getCollection("blog")).filter(
  (post) => post.data.published === true
).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
).slice(0, 5)
---

<Layout pageType="home">
  <section class="prose pt-10" transition:name="home-content">
    <p>Hey I am Waris, You might be here to check out <a href='https://asent.app' target="_blank">Asent</a> or some of my recent blogs:</p>
    <ul class="list-none! py-0 -mt-2 pl-0!">
      {
        posts.map((post, i) => (
          <li class="flex items-center motion-reveal" data-reveal style={`--reveal-delay: ${70 + i * 20}ms;`}>
            <kbd class="text-[10px] mr-2 font-mono select-none not-prose" style="color: var(--color-muted);">[{i + 1}]</kbd>
            <a href={`/post/${post.id}/`} class="motion-lift">{post.data.title}</a>
          </li>
        ))
      }
    </ul>

    <p class="pt-8">
        For the full blog list, check the archive page. For any other questions/feedback, feel free to reach out to me on <a href="https://twitter.com/wrsrsh" target="_blank">X</a> or <a href="mailto:hello@reshi.me">email</a>.
    </p>
  </section>

  <script>
    document.addEventListener("keydown", (e) => {
      if (
        e.target instanceof HTMLInputElement ||
        e.target instanceof HTMLTextAreaElement ||
        (e.target as HTMLElement).isContentEditable
      ) return;

      const num = parseInt(e.key);
      if (num >= 1 && num <= 9) {
        const links = document.querySelectorAll<HTMLAnchorElement>("section ul li a");
        const link = links[num - 1];
        if (link) {
          window.location.href = link.href;
        }
      }
    });
  </script>
</Layout>
